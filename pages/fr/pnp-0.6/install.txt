====== Installation ======
Nous allons expliquer comment installer PNP4Nagios ci-dessous. Pour suivre ce document il faut que nagios __fonctionne__ et soit __installé__ dans /usr/local/nagios .\\ 
**Attention:** L'article ci-dessous a été écrit pour la version développeur PNP 0.6.0. \\ 
Merci de noter que PNP doit être configuré après l'installation.

===== Installation et plus =====
L'installation de PNP est contrôlée par [[wpde>makefile]]s. Après avoir lancé ./configure, votre système est analysé et les variables sont transférées aux makefiles.

Décompressez PNP en tant qu'utilisateur root:
<code>
tar -xvzf pnp4nagios-HEAD.tar.gz
cd pnp4nagios
</code>

Lancez ./configure à partir du répertoire pnp4nagios.

<code>
./configure
</code>
**Note:** Si l'on ne spécifie aucune option, l'utilisateur et le groupe par défaut seront "nagios". Si vous avez configuré un autre utilisateur pour faire fonctionner Nagios, vous devez utiliser les paramètres suivants "--with-nagios-user" et "--with-nagios-group", respectivement. Avec un utilisateur et un groupe de nom icinga, la commande est
<code>
./configure --with-nagios-user=icinga --with-nagios-group=icinga
</code>
Une fois lancé, des lignes vont défiler à l’écran. Les dernières lignes ci-dessous sont importantes.

<code>
*** Configuration summary for pnp4nagios-0.6.2 23-12-2009 ***

  General Options:
  -------------------------         -------------------
  Nagios user/group:                nagios nagios
  Install directory:                /usr/local/pnp4nagios
  HTML Dir:                         /usr/local/pnp4nagios/share
  Config Dir:                       /usr/local/pnp4nagios/etc
  Location of rrdtool binary:       /usr/bin/rrdtool Version 1.2.12
  RRDs Perl Modules:                FOUND (Version 1.2012)
  RRD Files stored in:              /usr/local/pnp4nagios/var/perfdata
  process_perfdata.pl Logfile:      /usr/local/pnp4nagios/var/perfdata.log
  Perfdata files (NPCD) stored in:  /usr/local/pnp4nagios/var/spool

  Web Interface Options:  -------------------------         -------------------
  HTML URL:                         http://localhost/pnp4nagios/
  Apache Config File:               /etc/apache2/conf.d/pnp4nagios.conf


  Review the options above for accuracy.  If they look okay,
  type 'make all' to compile.</code>

Les chemins doivent être vérifiés. Si les chemins affichés ne sont pas corrects, ils doivent être modifiés en utilisant //./configure// avec les options appropriées.\\ 
**Attention:** "Location of rrdtool binary" veut dire le chemin avec le nom de l’exécutable! Si nécessaire, il peut être spécifié en utilisant la syntaxe suivantes:
<code>
   ./configure --with-rrdtool=/usr/local/rrdtool-1.2.xx/bin/rrdtool
</code>
<code>
   ./configure --help 
</code>
Montre toutes les options supportées.\\ \\ 

Lancer

<code>
   make all
</code>
compile les composants comme NPCD qui sont écrits en C.

<code>
   make install
</code>
copie tous les fichiers au bon endroit dans votre système de fichiers. Les chemins utilisés sont ceux qui vous ont été montrés lors de l'utilisation de la commande ./configure.

Après l'installation du programme et des fichiers HTML, vous pouvez copier l'exemple de configuration dans le dossier de configuration de votre serveur web
<code>
   make install-webconf
</code>

Optionnellement, le lancement de //make install-config//, vous copie les fichiers de configuration pour process_perfdata.pl et npcd dans etc/pnp.
<code>
   make install-config
</code>


Pour installer le script de lancement automatique d'NPCD lors du démarrage du serveur, lancez:
<code>
   make install-init
</code>

Pour lancer toutes les commandes précédentes les unes après les autres, lancez:
<code>
   make fullinstall
</code>

**Attention:** Après avoir copié les fichiers de configuration du serveur web, vous devez redémarrer votre serveur web (''service httpd restart'' ou ''/etc/init.d/apache2 restart'', selon votre distribution).

===== Mise à jour =====

La mise a jour vers la version 0.6.x se passe (à peut prêt) de la même manière que l'installation.
Notez que vous devez invoquez ''./configure'' avec les mêmes options que vous aviez utilisées lors de la première installation.
Vérifiez si vous avez fait des changements dans ''share/templates.dist''. Vos templates perso doivent être placées dans le dossier ''share/templates'' pour ne pas être écrasées.\\ 
**Attention**: Si vous avez changé //config.php// vous devez en faire une sauvegarde avant qu'il ne soit écrasé par la commande ''make install-config''.

Vous pouvez ignorer ''make install-webconf'' et ''make install-init'' car rien ne change entre les différentes versions 0.6.x.

===== Les composants =====

Après l'installation tous les composants de PNP on été copiés dans les emplacements suivants:

Les fichiers PHP pour l'interface web dans
   /usr/local/pnp4nagios/share/pnp

Le script process_perfdata.pl dans
   /usr/local/pnp4nagios/libexec

Les examples de configuration avec le suffixe ''-sample'' dans
   /usr/local/pnpnagios/etc

Le fichier de config config.php pour l'interface web dans
   /usr/local/pnp4nagios/etc

[[start|Retour a l'index]] | [[config|configuration]]