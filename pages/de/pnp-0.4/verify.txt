====== Prüfen der Installation ======

Wenn alle bis jetzt alles sauber funktioniert hat, kann PNP zum ersten Mal im Browser aufgerufen werden.

Davon ausgehend, dass Nagios unter der URL ''/nagios'' zu erreichen ist, lässt sich PNP nun unter ''/nagios/pnp/index.php'' aufrufen.

Ohne weitere Optionen aufgerufen sucht PNP nach RRD- und XML-Dateien in share/perfdata und zeigt alle Graphen des ersten Hosts in der Übersicht an.

ACHTUNG: Direkt nach dem (Neu-)Start von Nagios nach dem Aktivieren der Verarbeitung von Performance-Daten wird der Aufruf im Browser zu Fehlermeldungen führen, weil zunächst Performance-Daten gesammelt und in den RRD-Dateien abgelegt werden müssen. Abhängig vom Check-Intervall kann es einige Zeit dauern, bis Graphen angezeigt werden können.

===== Logfile =====


Während der Installation wurde durch den Aufruf von ''make install-config'' ein Beispiel-Config-File ''etc/pnp/process_perfdata.cfg-sample'' erzeugt. Die Werte in der sample-Datei entsprechen den Default-Werten, die auch in ''process_perfdata.pl'' fest hinterlegt sind, daher ist die ''process_perfdata.cfg'' für den Betrieb nicht zwingend notwendig.

Die Datei ''process_perfdata.cfg-sample'' kann somit als Vorlage für die ''process_perfdata.cfg'' dienen, die immer dann notwendig ist, wenn vom Standard abweichende Werte eingestellt werden sollen.

In der ''process_perfdata.**cfg**'' lässt sich das Verhalten von ''process_perfdata.pl'' vielfach beeinflussen.

Die wichtigsten Optionen für die Inbetriebnahme sind LOG_LEVEL und LOG_FILE. Im laufenden Betrieb sollte der Log-Level immer auf 0 gesetzt sein, um die Performance von process_perfdata.pl nicht durch unnötiges Schreiben von Logfiles zu beeinträchtigen.

Während der Inbetriebnahme sollte man jedoch den ''LOG_LEVEL'' auf "2" setzen, um zu sehen, was process_perfdata.pl bei der Verarbeitung der Performance-Daten so alles anstellt.

Spätestens bei [[about#support|Support Anfragen]] im Forum oder auf den Mailinglisten werden wir nach Auszügen aus dem perfdata.log fragen.



===== Was aber wenn nicht ? =====

Einige grundlegende Einstellungen sind zu prüfen.

1. Sind RRD- und XML-Files erzeugt worden ?


''process_perfdata.pl'' legt für jeden Host unter share/perfdata ein neues Verzeichnis an. In diesem Verzeichnis wird wiederum für jeden Service eine RRD-Datenbank und ein XML-File erstellt.
Allerdings liefern nicht alle Checks Performance-Daten, das gilt u.a. für "check_ping", die Alternative "check_icmp" dagegen erzeugt Daten (ab Nagios-Plugin-Version 1.4.12 liefert auch check_ping Performance-Daten).\\ 
Die Fehlermeldung "No valid RRD Files found" weist darauf hin, dass das Plugin KEINE Performance-Daten liefert! Teilweise muss man zusätzliche Optionen aktivieren, damit Performance-Daten ausgegeben werden. Evtl. kann das auch durch ein [[wrapper|Wrapper-Script]] geändert werden.\\ 
In den Detailinformationen zu jedem Host/Service gibt es das Feld "Performance-Data". Wenn dort keine Daten stehen, dann werden im jeweiligen Verzeichnis keine Dateien erzeugt und PNP kann deshalb auch keine grafischen Auswertungen liefern!\\ 
Das folgende Bild zeigt die Informationen zu einem "PING"-Service. Das blaue Feld enthält den vom Plugin gelieferten Text, das rote die Performance-Daten, die Nagios erkannt hat.\\ 
{{:srv_info.png?250|Informationen zu "PING"}}

2. Hat Nagios ''process_perfdata.pl'' aufgerufen ?

In der Config-Datei für process_perfdata.pl, der ''etc/pnp/process_perfdata.cfg'' lässt sich der Debug-Level erhöhen. Die Verarbeitung der Daten wird nun in ''var/perfdata.log'' protokolliert.

3. Grafiken werden ohne Text angezeigt ?

siehe [[about#anforderungen|Anforderungen]]

4. verify_pnp_config

Das Perl-Script [[verify_pnp_config|verify_pnp_config]] im ''contrib''-Verzeichnis des Installationsverzeichnisses ermöglicht die Prüfung von Konfigurationseinstellungen und zeigt, ob Performance-Daten vorhanden bzw. gültig sind. Die Syntax dafür ist ziemlich einfach:
<code>./verify_pnp_config -m <Modus></code> wobei ''<Modus>'' durch "default", "bulk" oder "npcd" zu ersetzen ist (ohne Anführungszeichen).

[[start|Zurück zur Doku]]